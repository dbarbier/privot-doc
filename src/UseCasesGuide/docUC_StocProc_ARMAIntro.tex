% Copyright (c)  2005-2010 EDF-EADS-PHIMECA.
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts.  A copy of the license is included in the section entitled "GNU
% Free Documentation License".
\renewcommand{\filename}{docUC_StocProc_NormalIntro.tex}
\renewcommand{\filetitle}{Intro}

% \HeaderNNIILevel
% \HeaderIILevel
%\HeaderIIILevel


\index{Stochastic Process!ARMA}




Under some general conditions, all the stationary stochastic process $\underline{X}(\omega,t)$ of dimension $d$ can be modeled by a discrete $ARMA(p,q)$ model defined at the time stamp $t$ by :
\begin{equation}\label{dimn}
 \vect{X}_t + \mat{A}_{\, 1}   \,  \vect{X}_{t-1} + \hdots +  \mat{A}_{\, p} \,   \vect{X}_{t-p} = 
   \vect{\varepsilon}_{t}+  \mat{B}_ {\, 1} \,   \vect{\varepsilon}_{t-1}+   \hdots + \mat{B}_{\, q}  \,  \vect{\varepsilon}_{t-q}
\end{equation}
where the coefficients of the recurrence are some matrix in $\mathbb{R}^d$ and $ \vect{\varepsilon}_t$ is a  discretisation on the time grid of a white noise.\\
The coefficients $(\mat{A}_{\, 1} , \hdots, \mat{A}_{\, p} )$ form the Auto Regressive (AR) part of the model, while the coefficients $(\mat{B}_{\, 1} \, \hdots, \mat{B}_{\, q}  )$ the Moving Average (MA) part. \\

In dimension 1, the linear recurrence writes : 

\begin{equation}\label{dim1}
X_t +a_1  X_{t-1} + \hdots +  a_p X_{t-p} = 
  \varepsilon_{t}+  b_1 \varepsilon_{t-1}+   \hdots +b_q \varepsilon_{t-q}
\end{equation}
where $(a_i,b_i) \in \mathbb{R}$.\\


Let us introduce the homogeneous system associated to (\ref{dimn}) :
\begin{equation}\label{dimnHom}
 \vect{X}_t + \mat{A}_{\, 1}   \,  \vect{X}_{t-1} + \hdots +  \mat{A}_{\, p} \,   \vect{X}_{t-p} = 0
\end{equation}


To get stationary solutions of (\ref{dimn}), it is necessary to get its characteristic polynomial defined in (\ref{PolPhi}) :
\begin{equation}\label{PolPhi}
\Phi(\vect{r}) = \vect{r}^p + \sum_{i=1}^p a_i\vect{r}^{p-i} 
\end{equation}


Thus the solutions of (\ref{dimnHom}) are of the form $P(t)=\vect{r}_i^t$ where the $\vect{r}_i$ are the roots of the polynomials $\Phi(\vect{r})$ defined in (\ref{PolPhi}) and $P$ is a polynomials of degree the order of the root $\vect{r}_i$ :


The processes  $P(t)\vect{r}_i^t$ decrease with time if and only if the modulus of all the components of the roots $\vect{r}_i$ are less than 1 : 
\begin{equation}\label{Modul}
  \forall i,j \in [1,d], \,  |r_{ij}| <1
\end{equation}

Once given the coefficients of the model $ARMA(p,q)$, Open TURNS evaluates  the roots of the polynomials $\Phi(\vect{r})$  and checks the previous  condition (\ref{Modul}). The roots $\vect{r}_i$, are the eigen values of the matrix $\mat{M}$ which writes in dimension $d$ as :
\begin{equation}\label{MatrixMdimn}
\mat{M} = \left( 
\begin{array}{cccccc}
  \mat{0}_{\, d} & \mat{1}_{\, d} & \mat{0}_{\, d} & \hdots & \mat{0}_{\, d} & \mat{0}_{\, d} \\
  \mat{0}_{\, d} & \mat{0}_{\, d} & \mat{1}_{\, d} & \hdots & \mat{0}_{\, d} & \mat{0}_{\, d}\\
  \hdots \\
  \mat{0}_{\, d} & \mat{0}_{\, d} & \mat{0}_{\, d} & \hdots & \mat{0}_{\, d} & \mat{1}_{\, d}\\
 - \mat{A}_{\, 1} & -\mat{A}_{\, 2} & - \mat{A}_{\, 3}& \hdots  & -\mat{A}_{\, p-1}& -\mat{A}_{\, p}
\end{array}
\right )
\end{equation}
and  in dimension 1 : 
\begin{equation}\label{MatrixMdim1}
\mat{M} = \left( 
\begin{array}{cccccc}
  0 & 1 & 0 & \hdots & 0 & 0\\
  0 & 0 & 1 & \hdots & 0 & 0\\
  \hdots \\
  0 & 0 & 0 & \hdots & 0 & 1\\
 -\alpha_1 & -\alpha_2 & -\alpha_3 & \hdots  & -\alpha_{p-1} & -\alpha_p
\end{array}
\right )
\end{equation}

The matrix $\mat{M}$ is known to be the companion matrix. 
