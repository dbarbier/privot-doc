% Copyright (c)  2005-2010 EDF-EADS-PHIMECA.
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts.  A copy of the license is included in the section entitled "GNU
% Free Documentation License".
\renewcommand{\filename}{docUC_RespSurface_PolyChaosExploitation.tex}
\renewcommand{\filetitle}{UC : Run and results exploitation  of a polynomial chaos algorithm : coefficients, polynomial model, multivariate basis, truncated multivariate basis, ...}

% \HeaderNNIILevel
% \HeaderIILevel
\HeaderIIILevel




The objective of this Use Case is to launch the  polynomial chaos algorithm and exploit all the associated results.\\



We note  $g : \mathbb{R}^n \longrightarrow \mathbb{R}^p $, $g(\vect{X}) = \vect{Y}$ the physical model  and $T : \mathbb{R}^n \longrightarrow \mathbb{R}^n $, $T(\vect{X}) = \vect{Z}$ the iso-probabilistic transformation.\\

Once the algorithm has run, it is possible to ask for the following results :
\begin{itemize}
\item the {\em composed model} : $h : \vect{Z}^{\strut} \longrightarrow \vect{Y} = g \circ T^{-1}(\vect{Z})$, which is the model of the reduced variables $\vect{Z}$. We have  $\displaystyle h =  \sum_{k \in \mathbb{N}} \vect{\alpha}_k \Psi_k$,
\item the coefficients of the polynomial approximation : $(\vect{\alpha}_k)_{k \in K}$,
\item the {\em composed meta model} : $\hat{h}$, which is the model of the reduced variables reduced to the truncated multivariate basis $(\Psi_k)_{k \in K}$. We have $\displaystyle  \hat{h} = \sum_{k \in K} \vect{\alpha}_k \Psi_k$,
\item the {\em meta model} : $\displaystyle \hat{g} : \vect{X} \longrightarrow Y = \hat{h} \circ T(\vect{X})$ which is the polynomial chaos approximation as a NumericalMathFunction. We have $\displaystyle \hat{g} = \sum_{k \in K} \vect{\alpha}_k \Psi_k \circ T$,
\item the truncated multivariate basis : $(\Psi_k)_{k \in K}$,
\item the indices $K$,
\item the composition of each polynomial of the truncated multivariate basis $\Psi_k$,
\item the distribution $\mu$ of the transformed variables $\vect{Z}$,
\end{itemize}



Details on response surface approximations may be found in the Reference Guide (\href{OpenTURNS_ReferenceGuide.pdf}{see files Reference Guide - Step Res. Surf. -- Functional Chaos Expansion and -- Polynomial Chaos Expansion}).\\

Details on each object may be found in the User Manual  (\href{OpenTURNS_UserManual_TUI.pdf}{see User Manual - Non Parametric Response Surface by Functional Chaos Expansion}).\\




Once the approximated model has been determined, it is possible to apply the Uncertainty Methodology with the new ouput variable of interest $\tilde{Y}$, instead of  the real one $Y$. The Use Case (\ref{RandomVectorPolynomialChaos}) illustrates how to create an output variable of interest from the result of the PolynomialChaosAlgorithm : {\itshape PolynomialChaosResult}.\\

\requirements{
  \begin{description}
  \item[$\bullet$] the  polynomial chaos algorithm : {\itshape polynomialChaosAlgorithm}
  \item[type:]    a FunctionalChaosAlgorithm
  \end{description}
}
{
  \begin{description}
  \item[$\bullet$] the  result structure : {\itshape polynomialChaosResult}
  \item[type:] a FunctionalChaosResult
  \item[$\bullet$] the coefficients : {\itshape coefficients}
  \item[type:] a NumericalSample
  \item[$\bullet$] : the indices $K$ : {\itshape subsetK}
  \item[type:] a Indices
  \item[$\bullet$] the composed model : {\itshape composedModel}
  \item[type:] a NumericalMathFunction
  \item[$\bullet$] the composed meta model : {\itshape composedMetaModel}
  \item[type:] a NumericalMathFunction
  \item[$\bullet$] the meta model : {\itshape metaModel}
  \item[type:] a NumericalMathFunction
  \item[$\bullet$]  the truncated multivariate basis : {\itshape multivariateBasisCollection}
  \item[type:] a NumericalMathFunctionCollection
  \item[$\bullet$] the distribution of the transformed variables : {\itshape mu}
  \item[type:] a Distribution
  \item[$\bullet$]   the composed model (of $\vect{Z}$) : {\itshape composedModel}
  \item[type:] a NumericalMathFunction
  \item[$\bullet$]   the projection strategy : {\itshape myProjStat}
  \item[type:] a ProjectionStrategy
  \end{description}
}

\textspace\\
Python  script for this UseCase :


\begin{lstlisting}
  # Perform the simulation
  polynomialChaosAlgorithm.run()

  # Stream out the result
  polynomialChaosResult = polynomialChaosAlgorithm.getResult()

  # Get the polynomial chaos coefficients
  # All the coefficients
  coefficients = result.getCoefficients()
  # The coefficients of marginal i
  coefficientsMarginal_i = result.getCoefficients()[i]

  # Get the indices of the selected polynomials : K
  subsetK = polynomialChaosResult.getIndices()

  # Get the composition of the polynomials
  # of the truncated multivariate basis
  for i in range(subsetK.getSize()) :
  print "Polynomial number ", i, " in truncated basis <-> polynomial number ", subsetK[i], " = ", LinearEnumerateFunction(dim)(subsetK[i]), " in complete basis"

  # Get the multivariate basis
  # as a colletion of NumericalMathFunction
  functionCollection = result.getReducedBasis()

  # Get the distribution of variables Z
  mu = result.getMeasure()

  # Get the composed model which is the model of the reduced variables Z
  composedModel = result.getComposedModel()

  # Get the composed meta model which is the model of the reduced variables Z
  # within the reduced polynomials basis
  composedMetaModel = result.getComposedMetaModel()

  # Get the meta model which is the composed meta model combined with the
  # iso probabilistic transformation
  metaModel = result.getMetaModel()

  # Get the projection strategy
  myProjStat = polynomialChaosAlgorithm.getProjectionStrategy()
\end{lstlisting}




