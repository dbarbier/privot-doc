% Copyright (c)  2005-2010 EDF-EADS-PHIMECA.
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts.  A copy of the license is included in the section entitled "GNU
% Free Documentation License".
\renewcommand{\etapemethodo}{C'}
\renewcommand{\nomfichier}{docref_Cprime211_ImportanceFactor}
\renewcommand{\titrefiche}{Importance Factors derived from Taylor Variance Decomposition  Method}

\Header

\MathematicalDescription{
  \textbf{\underline{Goal}}\\

  The importance factors derived from a quadratic combination method are defined to discriminate the influence of the different inputs towards the output variable for central dispersion analysis.\\


  \textbf{\underline{Principles}}\\

  The importance factors are derived from the following expression. It can be shown by Taylor expansion of the output variable $z$ ($n_Z = 1$) around $\ux = \muX$ and computation of the variance that :
  $$
  \Var Z \approx \nabla h(\muX).\Cov \uX .^t\nabla h(\muX)
  $$
  which can be re written :
  \begin{eqnarray*}
    \begin{split}
      & 1 & \approx & \ \ \sum_{i=1}^{n_X}\frac{\partial h(\muX)}{\partial X^i}\times\frac{  \sum_{j=1}^{n_X} \frac{\partial h(\muX)}{\partial x^j}.(\Cov \uX)_{ij} }{\Var Y}\\
      &  & \approx & \ \ \mathcal F_1 + \mathcal F_2 + \ldots + \mathcal F_{n_X}
    \end{split}
  \end{eqnarray*}

  \textbf{\underline{Vectorial definition}}\\

  $$
  \underline{\mathcal F} = \nabla h(\muX) \times \frac{\Cov \uX .^t\nabla h(\muX)}{\Var Z}
  $$

  \textbf{\underline{Scalar definition}}\\

  $$
  \mathcal F_i = \frac{\partial h(\muX)}{\partial x^i} \times \frac{\sum_{j=1}^{n_X} \frac{\partial h(\muX)}{\partial x^j}.(\Cov \uX)_{ij} }{\Var Y}
  $$

  where:
  \begin{itemize}
  \item $\nabla h(\ux) = \left( \frac{\partial h(\ux)}{\partial x^i}\right)_{i=1,\ldots,n_X}$ is the gradient of the model at the point $\ux$,
  \item $\Cov \uX$ is the covariance matrix,
  \item $\muX$ is the mean of the input random vector,
  \item $\Var Z$ is the variance of the output variable.
  \end{itemize}

  \textbf{\underline{Interpretation of the importance factors}}\\

  Let us note that this interpretation supposes that $(X^i)_i$ are independent.\\

  Each coefficient $\frac{\partial h(\ux)}{\partial x^i}$ is a linear estimate of the number of units change in the variable $y=h(\ux)$ as a result of a unit change in the variable $x^i$. This first term depends on the physical units of the variables and is  meaningful only when the units of the model are known. In the general case, as the variables have different physical units, it is not possible to compare these sensitivities $\frac{\partial h(\ux)}{\partial x^i}$ the one with the others. This is the reason why the importance factor used within Open TURNS are normalized factors. These factors enable to make the results comparable independently of the original units of the inputs of the model. The second term $\frac{\sum_{j=1}^{n_X} \frac{\partial h(\muX)}{\partial x^j}.(\Cov \uX)_{ij} }{\Var Z}$ is the renormalization factor.\\

  To summarize, the coefficients $(\mathcal F_i)_{i=1,\ldots,n_X}$ represent a linear estimate of the percentage change in the variable $z = h(\ux)$ caused by one percent change in the variable $x^i$. The importance factors are independent of the original units of the model, and are comparable with each other.

}
{
  Importance Factors derived from Perturbation Methods
}

\Methodology{

  These computations are part of the step C' of the global methodology. It requires to have performed the steps A, B and C.\\

}
{
  The computation of these importance factors enables to rank the influence of the input variables towards the output variable. These factors are computed 'near' the mean value of the output. Thus, it should not be used to evaluate the importance of the input variable around the tail of the output distribution (high level quantile for example).
}

\Example{
--
}
